---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 


```{r}
# Creat a table to represent the number of cells in each clusters for different idents, ("CMV & MEM").
count_table <- table(aligned_rat_merged@meta.data$seurat_clusters, aligned_rat_merged@meta.data$orig.ident)
count_table
```

```{r}
#To compute the sum of the total of cells in all cluster at each ident.
total_CMV <- sum(count_table[, "CMV_rat"])
total_MEM <- sum(count_table[,"MEM_rat"])
```

```{r}
#To compute the occurrence of cells in each cluster of both idents  "CMV"& "MEM" in rat.(ratio = The count of cell at each cluster over the total count of cell in all clusters)
percent_cmv_each_cluster <- count_table[, "CMV_rat"] / total_CMV * 100
percent_mem_each_cluster <- count_table[, "MEM_rat"] / total_MEM * 100
```

```{r}
#To visualize a bar plot for a better comparison of the occurrence of cells between both idents
plot <- barplot(rbind(percent_cmv_each_cluster, percent_mem_each_cluster),
        beside = TRUE, xlab = "Number of Clusters", ylab = "Percentage of Cells",
        main = "Cell Percentage per Cluster", legend.text = c("CMV_rat", "MEM_rat"))
```